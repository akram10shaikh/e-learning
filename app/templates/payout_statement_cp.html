<!DOCTYPE html>
{% load static %}
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <link rel="stylesheet" href="{% static 'assets_by_provider/css/payout_statement_cp.css' %}" />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"
    />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Raleway:ital,wght@0,100..900;1,100..900&display=swap"
      rel="stylesheet"
    />
  </head>
  <body>
    <section class="Dashboard">
      <!-- Left Slider -->
      <div class="sidebar">
        <div class="logoplusafter">
          <div class="logo">
            <img
              class="logos"
              src="{% static 'assets_by_provider/img/profile_by_provider/newlogo.png' %}"
              alt=""
              width="50px"
            />
          </div>
          <div class="after-logo">
            <p>UPSKyED</p>
          </div>
        </div>

        <nav>
          <ul>
            <li>
              <a href="{% url 'provider_index' %}">
                <span class="icon">
                  <img src="{% static 'assets_by_provider/img/profile_by_provider/home.png' %}" alt="" width="24px" />
                </span>
                &nbsp; Dashboard
              </a>
            </li>

            <li>
              <a href="{% url 'provider_profile' %}">
                <span class="icon"
                  ><img
                    src="{% static 'assets_by_provider/img/profile_by_provider/people.png' %}"
                    alt=""
                    width="20px"
                /></span>
                &nbsp;Profile
              </a>
            </li>
            <li>
              <a href="{% url 'provider_course' %}">
                <span class="icon"
                  ><img
                    src="{% static 'assets_by_provider/img/profile_by_provider/school1.png' %}"
                    alt=""
                    width="30px"
                /></span>
                Course details
              </a>
            </li>
            <li>
              <a href="{% url 'provider_payout_statement' %}">
                <span class="icon"
                  ><img src="{% static 'assets_by_provider/img/profile_by_provider/ps.png' %}" alt="" width="30px"
                /></span>
                Payout statement<span class="notification-dot"></span>
              </a>
            </li>
            <li>
              <a href="{% url 'provider_settings' %}">
                <span class="icon"
                  ><img
                    src="{% static 'assets_by_provider/img/profile_by_provider/settingss.png' %}"
                    alt=""
                    width="30px"
                /></span>
                Settings
              </a>
            </li>
            <li>
              <a href="#">
                <span class="icon"
                  ><img src="{% static 'assets_by_provider/img/profile_by_provider/info1.png' %}" alt="" width="30px"
                /></span>

                Info
              </a>
            </li>
            <li>
              <a href="{% url 'logout' %}">
                <span class="icon"
                  ><img src="{% static 'assets_by_provider/img/course_detail_sub_by_provider/logout.png' %}" alt="" width="30px"
                /></span>

                Logout
              </a>
            </li>
          </ul>
        </nav>
      </div>


      <!-- Middle Dashboard -->
      <div class="Dashboard-middle">
        <div class="first-section">
          <h3 class="crs">Payment statement</h3>
          <div class="input-section">
            <input type="text" placeholder="search" />
            <img
              src="{% static 'assets_by_provider/img/payout_statement_by_provider/search.png' %}"
              alt="search"
              style="width: 16px"
            />
          </div>

          <div class="Dashboard-right">
            <div class="dash-right-card">
              {% if profile == 10 %}
              <div class="profile-pic">
                <img src="{% static 'assets_by_provider/img/payout_statement_by_provider/profile.png' %}" alt="Profile Picture" />
                <div class="online-status"></div>
              </div>
              {% else %}
              <div class="profile-pic">
                <img src="{{ profile.profile_picture.url }}" alt="Profile Picture" />
                <div class="online-status"></div>
              </div>
              {% endif %}

              <div class="user-info-right">
                <div class="name">{{ request.user.username }}</div>
                <div class="role">UX/UI Designer</div>
              </div>
              <div class="notifications">
                <div class="notification-icon">
                  <span class="notification-count">2</span>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="profile-header">
          <div class="user-info">
            {% if profile == 10 %}
            <img src="{% static 'assets_by_provider/img/payout_statement_by_provider/profile.png' %}" alt="User Image" />
            {% else %}
            <img src="{{ profile.profile_picture.url }}" alt="User Image" />
            {% endif %}
            <div>
              <h1 class="hello-head">Hello, {{ request.user.username }}</h1>
              <p class="hello-para">Check your where you left</p>
            </div>
          </div>
          <div class="buttons">
            <button id="export-btnn">
              <img
                class="dwnld"
                src="{% static 'assets_by_provider/img/payout_statement_by_provider/dwnl.png' %}"
                alt=""
                width="20px"
              />
              Export
            </button>
            <button id="payment-btn">
              <img
                class="plus"
                src="{% static 'assets_by_provider/img/payout_statement_by_provider/plus.png' %}"
                alt=""
                width="20px"
              />
              Payment link
            </button>
          </div>
        </div>

        <div id="payment-container">
          <div class="header">
            <a href="#" class="active">All payments</a>
          </div>
          <!-- <hr /> -->
          <div class="filters">
            <div class="dropdown">
              <button class="dropbtn">
                <img
                  src="{% static 'assets_by_provider/img/payout_statement_by_provider/time-line.png' %}"
                  alt="dropdown icon"
                />
                Date range &#11167;
              </button>
              <div class="dropdown-content">

              </div>
            </div>
            <div class="dropdown">
              <button class="dropbtn">
                <img
                  src="{% static 'assets_by_provider/img/payout_statement_by_provider/flag-line.png' %}"
                  alt="dropdown icon"
                />
                Status &#11167;
              </button>
              <div class="dropdown-content">
                <!-- Status options -->

              </div>
            </div>
            <div class="dropdown">
              <button class="dropbtn">
                <img
                  src="{% static 'assets_by_provider/img/payout_statement_by_provider/bank-card-line.png' %}"
                  alt="dropdown icon"
                />
                P. Method &#11167;
              </button>
              <div class="dropdown-content">
                <!-- Payment method options -->

              </div>
            </div>
            <img
              class="sline"
              src="{% static 'assets_by_provider/img/payout_statement_by_provider/search-2-line.png' %}"
              alt=""
            />
            <input
              type="text"
              placeholder="Search by amount, payment method..."
              class="search-bar"
            />
          </div>
        </div>

        <!-- Paid payments  -->
        <div class="table-container">
          <h2 class="paid-paym">Paid Payments</h2>
          <table id="dataTable">
            <thead>
              <tr>
                <th>S.No</th>
                <th>Invoice No</th>
                <th>Name</th>
                <th>Month</th>
                <th>Course name</th>
                <th>No. of enrollments</th>
                <th>Per share</th>
                <th>Amount</th>
                <th>Proof</th>

              </tr>
            </thead>
            <tbody>
              {% for data in paid %}
              <tr>
                <th>{{ forloop.counter }}</th>
                <th>{{ data.invoice_id }}</th>
                <th>{{ data.student }}</th>
                <th>{{ data.date_of_payment }}</th>
                <th>{{ data.course }}</th>
                <th>{{ data.enrollment }}</th>
                <th>$ 25</th>
                <th>RS {{ data.amount_paid }}</th>
                <th>{{ data.transaction_id }}</th>

              </tr>
              {% endfor %}
            </tbody>
          </table>
          <div class="pagination">
            <span id="resultsCount"></span>
            <div class="page-controls">
              <button id="prevBtn">&lt;</button>
              <select id="pageSelect"></select>
              <button id="nextBtn">&gt;</button>
              <span id="pageInfo"></span>
            </div>
          </div>
        </div>

        <!-- Pending Payments  -->

        <div class="table-container2">
          <h1>Pending payments</h1>
          <table class="dynamic-table">
            <thead>
              <tr>
                <th>S.No</th>
                <th>Invoice No</th>
                <th>Name</th>
                <th>Month</th>
                <th>Course name</th>
                <th>No of enrollments</th>
                <th>Per share</th>
                <th>Amount</th>
              </tr>
            </thead>
            <tbody>
              {% for data_unpaid in unpaid %}
              <tr>
                <th>{{ forloop.counter }}</th>
                <th>{{ data_unpaid.invoice_id }}</th>
                <th>{{ data_unpaid.student }}</th>
                <th>{{ data_unpaid.date_of_payment }}</th>
                <th>{{ data_unpaid.course }}</th>
                <th>{{data_unpaid.enrollment }}/th>
                <th>$ 25</th>
                <th>{{ data_unpaid.amount_paid }}</th>
              </tr>
              {% endfor %}
            </tbody>
          </table>
          <div class="pagination2">
            <button id="prevBtn2" onclick="prevPage()">Previous</button>
            <div class="results-info2" id="results-info2"></div>
            <button id="nextBtn2" onclick="nextPage()">Next</button>
          </div>
        </div>
      </div>
    </section>

    <!-- Footer Up Section -->
    <section class="footer-up">
      <div class="foot-left">
        <h2>UPSKyEd</h2>
        <p>
          Top learning experiences that create more <br />talent in the world.
        </p>
      </div>

      <div class="foot-right">
        <div class="product">
          <h2>Product</h2>
          <ul>
            <!-- <li>Overview</li> -->
            <li><a href="">Overview</a></li>
            <li><a href="">Features</a></li>
            <li><a href="">Solutions</a></li>
            <li><a href="">Tutorials</a></li>
            <li><a href="">Pricing</a></li>
          </ul>
        </div>
        <div class="product">
          <h2>Company</h2>
          <ul>
            <li><a href="">About us</a></li>
            <li><a href="">Careers</a></li>
            <li>
              <a href="">Press</a>
            </li>
            <li><a href="">News</a></li>
          </ul>
        </div>
        <div class="product">
          <h2>Social</h2>
          <ul>
            <li><a href="">Twitter</a></li>
            <li><a href="">Linkedin</a></li>
            <li><a href="">GitHub</a></li>
            <li><a href="">Dribble</a></li>
          </ul>
        </div>
        <div class="product">
          <h2>Legal</h2>
          <ul>
            <li><a href="">Terms</a></li>
            <li><a href="">Privacy</a></li>
            <li><a href="">Cookies</a></li>
            <li><a href="">Contact</a></li>
          </ul>
        </div>
      </div>
    </section>

    <!-- Footer Section -->
    <section class="footer">
      <div class="footer-left">
        <h2>Â© 2024 UPSKyEd. All rights reserved.</h2>
      </div>

      <div class="footer-right">
        <div class="icon1">
          <a href="">
            <img src="{% static 'assets_by_provider/img/course_by_provider/Social icon.png' %}" alt="img"
          /></a>

          <a href="">
            <img src="{% static 'assets_by_provider/img/course_by_provider/linkedin.png' %}" alt="img"
          /></a>

          <a href=""> <img src=".{% static 'assets_by_provider/img/course_by_provider/fb.png' %}" alt="img" /></a>

          <a href=""> <img src="{% static 'assets_by_provider/img/course_by_provider/github.png' %}" alt="img" /></a>

          <a href=""> <img src="{% static 'assets_by_provider/img/course_by_provider/ball.png' %}" alt="img" /></a>
        </div>
      </div>
    </section>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="{% static 'assets_by_provider/js/payout_statement_cp.js' %}"></script>

    <script>
  document.querySelector('.search-bar').addEventListener('input', function () {
    const searchTerm = this.value.toLowerCase();
    const table = document.getElementById('dataTable');
    const rows = table.tBodies[0].rows;

    for (let row of rows) {
      // Get relevant columns text - customize based on which columns you want to search
      const amount = row.cells[7].textContent.toLowerCase();
      const paymentMethod = row.cells[8].textContent.toLowerCase(); // assuming 9th col is Proof or Payment Method

      // Combine them for a multi-column search
      const combinedText = amount + ' ' + paymentMethod;

      if (combinedText.includes(searchTerm)) {
        row.style.display = '';
      } else {
        row.style.display = 'none';
      }
    }
  });
</script>
<script>
  document.getElementById('export-btnn').addEventListener('click', function () {
    const table = document.getElementById('dataTable');
    const rows = table.querySelectorAll('tr');
    let csvContent = '';

    rows.forEach(row => {
      const cols = row.querySelectorAll('th, td');
      const rowData = [];
      cols.forEach(col => {
        // Escape quotes and commas in cell content
        let text = col.textContent.replace(/"/g, '""');
        rowData.push(`"${text}"`);
      });
      csvContent += rowData.join(',') + '\n';
    });

    // Create a downloadable Blob from the CSV string
    const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
    const url = URL.createObjectURL(blob);

    // Create and click a download link
    const link = document.createElement('a');
    link.setAttribute('href', url);
    link.setAttribute('download', 'paid_payments.csv');
    link.style.display = 'none';
    document.body.appendChild(link);
    link.click();
    document.body.removeChild(link);
  });
</script>


  </body>
</html>
